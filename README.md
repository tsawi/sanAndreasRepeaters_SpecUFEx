# sanAndreasRepeaters_SpecUFEx
Unsupervised machine-learning of a repeating earthquake sequence in the San Andreas Fault Zone

### In progress (Jan 2022)

We focus on the northern section of San Andreas Fault (SAF) where tectonics are simpler and creep rates are somewhat consistent over the 40 year time period. For this study, Felix Waldhouser identified a repeating event of 16 earthquakes within the Southern California Seismic Network (SCSN)catalog of Mw>5 earthquakes from 1984 to 2019. The 16 earthquakes occur throughout the 35-year time period, have highly similar waveforms, and are co-located within 500m, or so. Waldhauser then selected all events within 5 km distance from the repeaters to include about 4000 events in total. He chose the station BAV since it was operational continuously since 1984 and had the most highly correlated repeater seismograms. BAV is about 20 km alway from the repeater events, in the dilational quadrant on the North American plate. 
 
Not all the events in the catalog have picks at station BAV, so there are fewer events in the pick file. 

A previous study (Sawi et al., 2022; in prep) showed how unsupervised machine-learning (UML) could be used to identify highly-similar waveforms of icequakes that may have eluded cross-correlation-based similarity matching because of the introduction of uncorrelated background seismic noise. The UML method, called SpecUFEx (Holtzman et al., 2018) infers time-varying spectral patterns within spectrograms and reduces them to charactersitic features called "fingerprints".

I wonder if more repeater earthquakes may exist in SCSN catalog that may only be detected through the SpecUFEx method of feature extraction. We will use the fingerprints of the repeater events to find similar fingerprints (similar in Euclidean distance), which presumably should have been generated by similar waveforms. When I say similar, I mean visually, because the point is that the purely statistical, quantitaive method of cross-correlating waveforms for similarity may fail, see WHAT was it || and Sawi et al., 2022)

It would be an interesting question then, if new repeaters are discoverd, what if the newly-discovered repeaters have highly similar waveforms but are in a location? Or, what if the waveforms are somewhat, but maybe arguable _not_ similar visually? Where does one draw the line? Or, should one draw the line? Maybe a slightly changing waveform means a slightly changing structure of the fault, which could be interesting. 


Good references on repeaters:

* 1. Gobal review of repeating earthquakes (2019) https://www.researchgate.net/profile/Roland-Burgmann/publication/330427991_Repeating_Earthquakes/links/5cdd562e299bf14d959d6847/Repeating-Earthquakes.pdf

* 2. Includes background about creep on SAF, repeating earthquakes (2015) https://agupubs.onlinelibrary.wiley.com/doi/full/10.1002/2015JB011998



## Steps:

** We have a catalog of all ~4000 earthquakes with waveforms, with an extra boolean column called "isRepeater" (1 if the earthquake was identified by Walhauser as a repeater, 0 if not)

** We use waveforms from 1 s before the P arrival time to 20 secs after (script 0) 

** Save waveforms as HDF5 (script 1 ; later to ASDF)

** Convert the waveforms to spectrograms (save them in HDF5)

** Use SpecUFEx on the spectrograms (from HDF5), and save fingerprints in HDF5 and to file as CSV output (script 3)

** Reduce fingerprints to 3D using PCA (CSV -> CSV)

** Visualize -- where are the repeaters within the PCA space? 

** We gather all fingerprints within some PCA-euclidean distance of the repeater earthquakes; this is a subset of the catalog called the "FPR" Fingerprint Repeaters; that is, earthquakes with highly-similar fingerprints, in the way that earthquakes with highly-similar waveforms are repeaters. 

** Stack FPR waveforms based on CC-maximizing for visualization.

** Where are the FPR in relation to the original repeaters? Colocated, or in other places? 








